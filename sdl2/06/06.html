<doctype html>
<html>
	<head>
<script>
  (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
  (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
  m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
  })(window,document,'script','https://www.google-analytics.com/analytics.js','ga');

  ga('create', 'UA-83606680-1', 'auto');
  ga('send', 'pageview');

</script>
		<meta charset="utf-8">
		<link rel="stylesheet" href="..\..\styles.css">
		<link rel="stylesheet" href="..\styles.css">
		<link rel="stylesheet" media="screen and (max-width: 1300px)" href="..\..\thin.css">
		<script src="https://cdn.rawgit.com/google/code-prettify/master/loader/run_prettify.js"></script>
		<title>Lesson 06 - Sound &amp; Extension Libraries</title>
	</head>
	<body>
	<header>
		<a class="top_button" href="..\05\05.html" id="last">Last</a>
		<a class="top_button" href="..\07\07.html" id="next">Next</a>
	</header>
	<div id="main">
		<header role="banner">
			<h1>Lesson 06 - Sound &amp; Extension Libraries</h1>
			<a id="home"  href="..\..\index.html">Home</a>
			<nav role="navigation">
				<ul class="subsections">
					<li><a href="#ext">Extension Libraries</a></li> | 
					<li><a href="#setup">Setup</a></li> | 
					<li><a href="#image">SDL_Image</a></li> | 
					<li><a href="#mixer">SDL_Mixer</a></li>
				</ul>
			</nav>
		</header>
		<main role="main" class="nocollapse">
			<aside role="complementary" class="example_program top">
			<h2>Example Program</h2>
			<div class="example_links">
				<a href="example.zip" download>Download</a>
			</div>
			<pre class="example_program prettyprint">#include &lt;iostream&gt;

#include &lt;SDL.h&gt;
#include &lt;SDL_image.h&gt;
#include &lt;SDL_mixer.h&gt;

using namespace std;

bool init();
void kill();
bool loop();

// Pointers to our window, renderer, texture, music, and sound
SDL_Window* window;
SDL_Renderer* renderer;
SDL_Texture* texture;
Mix_Music* music;
Mix_Chunk* sound;

int main(int argc, char** args) {

	if ( !init() ) {
		system("pause");
		return 1;
	}

	while ( loop() ) {
		// wait before processing the next frame
		SDL_Delay(10); 
	}

	kill();
	return 0;
}

bool loop() {

	static const unsigned char* keys = SDL_GetKeyboardState( NULL );

	SDL_Event e;
	SDL_Rect dest;

	// Clear the window to white
	SDL_SetRenderDrawColor( renderer, 255, 255, 255, 255 );
	SDL_RenderClear( renderer );

	// Event loop
	while ( SDL_PollEvent( &amp;e ) != 0 ) {
		switch (e.type) {
			case SDL_QUIT:
				return false;
			case SDL_KEYDOWN:
				if ( e.key.keysym.sym == SDLK_SPACE ) {
					if ( Mix_PausedMusic() == 1 ) {
						Mix_ResumeMusic();
					} else {
						Mix_PauseMusic();
					}
				} else if ( e.key.keysym.sym == SDLK_ESCAPE ) {
					Mix_HaltMusic();
				}
				break;
			case SDL_MOUSEBUTTONDOWN:
				// Play sound once on any available channel
				Mix_PlayChannel( -1, sound, 1 );
				break;
		}
	}

	// Render texture
	SDL_RenderCopy(renderer, texture, NULL, NULL);

	// Update window
	SDL_RenderPresent( renderer );

	return true;
}

bool init() {
	if ( SDL_Init( SDL_INIT_EVERYTHING ) &lt; 0 ) {
		cout &lt;&lt; "Error initializing SDL: " &lt;&lt; SDL_GetError() &lt;&lt; endl;
		return false;
	} 

	// Initialize SDL_image with PNG loading subsystem
	if ( IMG_Init(IMG_INIT_PNG) &lt; 0 ) {
		cout &lt;&lt; "Error initializing SDL_image: " &lt;&lt; IMG_GetError() &lt;&lt; endl;
		system("pause");
		return false;
	}

	// Initialize SDL_mixer with our audio format
	if ( Mix_OpenAudio( 44100, MIX_DEFAULT_FORMAT, 2, 1024 ) &lt; 0 ) {
		cout &lt;&lt; "Error initializing SDL_mixer: " &lt;&lt; Mix_GetError() &lt;&lt; endl;
		return false;
	}

	window = SDL_CreateWindow( "Example", SDL_WINDOWPOS_UNDEFINED, SDL_WINDOWPOS_UNDEFINED, 640, 480, SDL_WINDOW_SHOWN );
	if ( !window ) {
		cout &lt;&lt; "Error creating window: " &lt;&lt; SDL_GetError()  &lt;&lt; endl;
		return false;
	}

	renderer = SDL_CreateRenderer( window, -1, SDL_RENDERER_ACCELERATED );
	if ( !renderer ) {
		cout &lt;&lt; "Error creating renderer: " &lt;&lt; SDL_GetError() &lt;&lt; endl;
		return false;
	}

	// Load image (PNG) into surface
	SDL_Surface* buffer = IMG_Load("test.png");
	if ( !buffer ) {
		cout &lt;&lt; "Error loading image test.png: " &lt;&lt; SDL_GetError() &lt;&lt; endl;
		return false;
	}

	// Create texture
	texture = SDL_CreateTextureFromSurface( renderer, buffer );
	// Free surface as it's no longer needed
	SDL_FreeSurface( buffer );
	buffer = NULL;
	if ( !texture ) {
		cout &lt;&lt; "Error creating texture: " &lt;&lt; SDL_GetError() &lt;&lt; endl;
		return false;
	}

	// Load music
	music = Mix_LoadMUS("music.wav");
	if ( !music ) {
		cout &lt;&lt; "Error loading music: " &lt;&lt; Mix_GetError() &lt;&lt; endl;
		return false;
	}

	// Load sound
	sound = Mix_LoadWAV("scratch.wav");
	if ( !sound ) {
		cout &lt;&lt; "Error loading sound: " &lt;&lt; Mix_GetError() &lt;&lt; endl;
		return false;
	}

	// Play music forever
	Mix_PlayMusic( music, -1 );

	return true;
}

void kill() {
	SDL_DestroyTexture( texture );
	Mix_FreeMusic( music );
	Mix_FreeChunk( sound );
	texture = NULL;
	music = NULL;
	sound = NULL;

	SDL_DestroyRenderer( renderer );
	SDL_DestroyWindow( window );
	window = NULL;
	renderer = NULL;

	SDL_Quit();
	IMG_Quit();
	Mix_Quit();
}</pre>
		</aside>
		<article role="article">
			<h2 id="ext">Extension Libraries</h2>
			<p>
				While SDL provides extensive APIs for several systems, it omits some areas, and lacks features in others. Extension libraries solve this problem, adding more functionality in a modular fashion.
			</p>
			<span>Popular Extensions:</span>
			<div class="nocollapse blocks"><ul class="collumns">
				<li><a href="https://www.libsdl.org/projects/SDL_image/">SDL_Image</a></li>
				<span>Loads images of various types</span>
				<li><a href="https://www.libsdl.org/projects/SDL_mixer/">SDL_Mixer</a></li>
				<span>Provides a sound API</span>
				<li><a href="https://www.libsdl.org/projects/SDL_ttf/">SDL_TTF</a></li>
				<span>Provides a font loading and rendering API</span>
			</ul>
			<ul class="collumns">
				<li><a href="https://www.libsdl.org/projects/SDL_net/">SDL_Net</a></li>
				<span>Provides a networking API</span>
				<li><a href="https://github.com/grimfang4/sdl-gpu/releases">SDL_GPU</a> [beta]</li>
				<span>Replaces the rendering API</span>
				<li><a href="https://github.com/grimfang4/SDL_FontCache">SDL_FontCache</a> [beta]</li>
				<span>Provides font caching support</span>
			</ul></div>
			<p>
				We'll cover setting up and using <a href="https://www.libsdl.org/projects/SDL_image/">SDL_Image</a> and <a href="https://www.libsdl.org/projects/SDL_mixer/">SDL_Mixer</a> in this lesson. 
			</p>
			<h2 id="setup">Setup</h2>
			<p>
				To use an extension library, you must add to your project settings. The process is very similar to setting up SDL in the first place.
			</p>
			<span>Guides:</span>
			<ul class="content_list">
				<li><a href="vsSetup.html">Setup for Visual Studio</a></li>
				<li><a href="http://lazyfoo.net/tutorials/SDL/06_extension_libraries_and_loading_other_image_formats/index.php" target="_blank">Other Setup Guides</a></li>
			</ul>
			<h2 id="image">SDL_Image</h2>
			<p>
				As of yet, we've only been able to load bitmap images. This is a pain for several reasons&mdash;bitmaps cannot be compressed, it's difficult to get them to save alpha data, and most images downloaded from the web will not be in the correct format. SDL_Image adds a small set of functions for loading other image types, including PNG, JPG, GIF, and TIFF.
			</p>
			<h3>Startup</h3>
			<p>
				
			</p>
			<h3>Image Loading</h3>
			<p>
				
			</p>
			<h3>Shutdown</h3>
			<p>
				
			</p>
			<h2 id="mixer">SDL_Mixer</h2>
			<p>
				
			</p>
			<h3>Startup</h3>
			<p>
				
			</p>
			<h3>Audio Loading</h3>
			<p>
				
			</p>
			<h3>Playing Music</h3>
			<p>
				
			</p>
			<h3>Playing Sounds</h3>
			<p>
				
			</p>
			<h3>Controlling Playback</h3>
			<p>
				
			</p>
			<h3>Shutdown</h3>
			<p>
				
			</p>
		</article>
			<aside role="complementary" class="example_program bot">
			<h2>Example Program</h2>
			<div class="example_links">
				<a href="example.zip" download>Download</a>
			</div>
			<pre class="example_program prettyprint">#include &lt;iostream&gt;

#include &lt;SDL.h&gt;
#include &lt;SDL_image.h&gt;
#include &lt;SDL_mixer.h&gt;

using namespace std;

bool init();
void kill();
bool loop();

// Pointers to our window, renderer, texture, music, and sound
SDL_Window* window;
SDL_Renderer* renderer;
SDL_Texture* texture;
Mix_Music* music;
Mix_Chunk* sound;

int main(int argc, char** args) {

	if ( !init() ) {
		system("pause");
		return 1;
	}

	while ( loop() ) {
		// wait before processing the next frame
		SDL_Delay(10); 
	}

	kill();
	return 0;
}

bool loop() {

	static const unsigned char* keys = SDL_GetKeyboardState( NULL );

	SDL_Event e;
	SDL_Rect dest;

	// Clear the window to white
	SDL_SetRenderDrawColor( renderer, 255, 255, 255, 255 );
	SDL_RenderClear( renderer );

	// Event loop
	while ( SDL_PollEvent( &amp;e ) != 0 ) {
		switch (e.type) {
			case SDL_QUIT:
				return false;
			case SDL_KEYDOWN:
				if ( e.key.keysym.sym == SDLK_SPACE ) {
					if ( Mix_PausedMusic() == 1 ) {
						Mix_ResumeMusic();
					} else {
						Mix_PauseMusic();
					}
				} else if ( e.key.keysym.sym == SDLK_ESCAPE ) {
					Mix_HaltMusic();
				}
				break;
			case SDL_MOUSEBUTTONDOWN:
				// Play sound once on any available channel
				Mix_PlayChannel( -1, sound, 1 );
				break;
		}
	}

	// Render texture
	SDL_RenderCopy(renderer, texture, NULL, NULL);

	// Update window
	SDL_RenderPresent( renderer );

	return true;
}

bool init() {
	if ( SDL_Init( SDL_INIT_EVERYTHING ) &lt; 0 ) {
		cout &lt;&lt; "Error initializing SDL: " &lt;&lt; SDL_GetError() &lt;&lt; endl;
		return false;
	} 

	// Initialize SDL_image with PNG loading subsystem
	if ( IMG_Init(IMG_INIT_PNG) &lt; 0 ) {
		cout &lt;&lt; "Error initializing SDL_image: " &lt;&lt; IMG_GetError() &lt;&lt; endl;
		system("pause");
		return false;
	}

	// Initialize SDL_mixer with our audio format
	if ( Mix_OpenAudio( 44100, MIX_DEFAULT_FORMAT, 2, 1024 ) &lt; 0 ) {
		cout &lt;&lt; "Error initializing SDL_mixer: " &lt;&lt; Mix_GetError() &lt;&lt; endl;
		return false;
	}

	window = SDL_CreateWindow( "Example", SDL_WINDOWPOS_UNDEFINED, SDL_WINDOWPOS_UNDEFINED, 640, 480, SDL_WINDOW_SHOWN );
	if ( !window ) {
		cout &lt;&lt; "Error creating window: " &lt;&lt; SDL_GetError()  &lt;&lt; endl;
		return false;
	}

	renderer = SDL_CreateRenderer( window, -1, SDL_RENDERER_ACCELERATED );
	if ( !renderer ) {
		cout &lt;&lt; "Error creating renderer: " &lt;&lt; SDL_GetError() &lt;&lt; endl;
		return false;
	}

	// Load image (PNG) into surface
	SDL_Surface* buffer = IMG_Load("test.png");
	if ( !buffer ) {
		cout &lt;&lt; "Error loading image test.png: " &lt;&lt; SDL_GetError() &lt;&lt; endl;
		return false;
	}

	// Create texture
	texture = SDL_CreateTextureFromSurface( renderer, buffer );
	// Free surface as it's no longer needed
	SDL_FreeSurface( buffer );
	buffer = NULL;
	if ( !texture ) {
		cout &lt;&lt; "Error creating texture: " &lt;&lt; SDL_GetError() &lt;&lt; endl;
		return false;
	}

	// Load music
	music = Mix_LoadMUS("music.wav");
	if ( !music ) {
		cout &lt;&lt; "Error loading music: " &lt;&lt; Mix_GetError() &lt;&lt; endl;
		return false;
	}

	// Load sound
	sound = Mix_LoadWAV("scratch.wav");
	if ( !sound ) {
		cout &lt;&lt; "Error loading sound: " &lt;&lt; Mix_GetError() &lt;&lt; endl;
		return false;
	}

	// Play music forever
	Mix_PlayMusic( music, -1 );

	return true;
}

void kill() {
	SDL_DestroyTexture( texture );
	Mix_FreeMusic( music );
	Mix_FreeChunk( sound );
	texture = NULL;
	music = NULL;
	sound = NULL;

	SDL_DestroyRenderer( renderer );
	SDL_DestroyWindow( window );
	window = NULL;
	renderer = NULL;

	SDL_Quit();
	IMG_Quit();
	Mix_Quit();
}</pre>
		</aside>
		</main>
		<footer role="contentinfo">
			<p>Made by Maxwell Slater &copy; 2016 | Contact me at <a href="mailto:mslater@nevada.unr.edu">mslater@nevada.unr.edu</a> | <a href="https://github.com/TheNumbat/cpp-course">View this project on GitHub</a></p>
		</footer>
	</div>
	</body>
</html>